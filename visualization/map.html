<!DOCTYPE html>
<meta charset="utf-8">
<style>

/* CSS goes here. */

</style>
<body>
<script src="http://d3js.org/d3.v3.min.js"></script>
<script src="http://d3js.org/queue.v1.min.js"></script>
<script src="http://d3js.org/topojson.v1.min.js"></script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>

<style>
body{
	margin: 0;
	padding: 0;
	top: 0;
	left: 0;
}


</style>

<script>

var width = $(window).width(),
    height = $(window).height();

var treasure_map = ['#568C82', '#D9C8A9', '#BF884A', '#363535', '#B52A33'];
var vintage_map = ['#262401', '#A6A381', '#8DA387', '#261501', '#0D0300'];
var city_map = ['#BF2C38', '#BFD1D9', '#A6BFA3', '#84A651', '#6A9CB3'];
var nyc_map = ['#F21D2F', '#6DDAF2', '#B8D971', '#EBF2B6', '#BFB99B'];


var svg = d3.select("body").append("svg")
    .attr("width", width)
    .attr("height", height)
    .style('background-color', nyc_map[1]);

queue()
    .defer(d3.csv, "data/location.csv")
    .await(ready);

function ready(error, tweets){
	d3.json("data/nyc.json", function(error, nyc) {
		if (error) return console.error(error);

		var subunits = topojson.feature(nyc, nyc.objects.boroughs);
		var projection = d3.geo.albers()
			.center([0, 40.71])
			.rotate([74.0, 0])
			.parallels([50, 60])
			.scale(105000)
			.translate([width / 2, height / 2]);

		var path = d3.geo.path()
			.projection(projection)
			.pointRadius(3);

		svg.append("path")
			.datum(subunits)
			.attr("d", path)
			.style('fill', nyc_map[3]);
		var point = svg.append("path")
			.datum({type: "MultiPoint", coordinates: tweets})
			.attr("class", "points")
			.attr("d", path)
			.attr('height', '25px')
			.style('fill', nyc_map[0]);

		point.append('svg:animate') .attr('attributeName', 'opacity') .attr('from', '0') .attr('to', '1') .attr('dur', 1).attr('opacity', '1');
	});
}

</script>